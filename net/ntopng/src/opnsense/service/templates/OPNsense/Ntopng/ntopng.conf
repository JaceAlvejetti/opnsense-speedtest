{% if helpers.exists('OPNsense.ntopng.general.enabled') and OPNsense.ntopng.general.enabled == '1' %}
{% from 'OPNsense/Macros/interface.macro' import physical_interface %}
{%   if helpers.exists('OPNsense.ntopng.general.interface') and OPNsense.ntopng.general.interface != '' %}
{%       for listen_interface in OPNsense.ntopng.general.interface.split(',') %}
-i={{ physical_interface(listen_interface) }}
{%       endfor %}
{%   endif %}
{%   if helpers.exists('OPNsense.ntopng.general.httpport') and OPNsense.ntopng.general.httpport != '' %}
-w={{ OPNsense.ntopng.general.httpport }}
{%   endif %}
{%   if helpers.exists('OPNsense.ntopng.general.httpsport') and OPNsense.ntopng.general.httpsport != '' %}
-W={{ OPNsense.ntopng.general.httpsport }}
{%   endif %}
{%   if helpers.exists('OPNsense.ntopng.general.dnsmode') and OPNsense.ntopng.general.dnsmode != '' %}
-n={{ OPNsense.ntopng.general.dnsmode }}
{%   endif %}
{%   if helpers.exists('OPNsense.ntopng.general.disablelogin') and OPNsense.ntopng.general.disablelogin != '' %}
#-l={{ OPNsense.ntopng.general.disablelogin }}
{% endif %}
{%   if helpers.exists('OPNsense.ntopng.general.nopromisc') and OPNsense.ntopng.general.nopromisc == '1' %}
#-u
{% endif %}
{%   if helpers.exists('OPNsense.ntopng.general.localnets') and OPNsense.ntopng.general.localnets != '' %}
#-m "{{ OPNsense.ntopng.general.localnets }}"
{%   endif %}
{%   if helpers.exists('OPNsense.ntopng.general.redis') and OPNsense.ntopng.general.redis != '' %}
#-r "{{ OPNsense.ntopng.general.redis }}"
{%   endif %}
{%   if helpers.exists('OPNsense.ntopng.general.communityedition') and OPNsense.ntopng.general.communityedition != '' %}
--community
{%   endif %}
-d=/var/db/ntopng
{% endif %}
